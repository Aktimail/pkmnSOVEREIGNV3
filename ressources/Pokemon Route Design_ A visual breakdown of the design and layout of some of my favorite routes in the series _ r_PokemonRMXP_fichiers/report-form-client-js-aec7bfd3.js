import{t,_ as e,g as s,c as i,s as r,e as o,n,P as a,T as d,a as l,K as c,G as u}from"./shell-a9dcd804.js";import{s as h,x as p,c as g}from"./icon-d7ad820f.js";import"./shreddit-community-search-d1896484.js";import{N as m,S as b,F as S,R as v,a as E}from"./types-ba1b15db.js";import{b as y,a as f}from"./report-flow-eeed60cc.js";import{h as k}from"./index-bba3d6e7.js";import"./faceplate-form-f63ed129.js";import"./faceplate-progress-433a18f1.js";import"./validate-image-9f48337a.js";import"./faceplate-radio-input-b52ca406.js";import"./shreddit-slotter-c16b4012.js";import{a as B,b as A,c as R,d as L}from"./submit-report-helper-a064b6c4.js";import{c as T}from"./zendesk-step-helper-a4df236d.js";import"./index-b42a465d.js";import"./constants-775ffd1d.js";import"./filterNullish-9ec33a16.js";import"./community-picker-75beb711.js";import"./select-controller-b7a961d7.js";import"./user-flair-aefa9eac.js";import"./age-gate-standalone-client-js-55e13342.js";import"./faceplate-search-input-28db656a.js";import"./text-input-1e857ee0.js";import"./helpers-8837cd77.js";var w;let x=w=class extends h{constructor(){super(...arguments),this.repopulateScreen=()=>{const t=this.reportFormManager?.banEvasionSubredditNode,e=this.reportFormManager?.formValues?.[w.subredditFieldName];t&&e&&(this.subredditNode=t,this.reportFormManager.nextAction=w.nextAction,this.reportFormManager.updateButton(!1));const s=this.reportFormManager?.banEvasionAdditionalUserNodes,i=this.reportFormManager?.formValues?.[w.usersFieldName];s&&i&&(this.initializeUserInput(),this.userInput.selectedRedditorTemplates=s)},this.clearSubredditSelection=()=>{this.dispatchEvent(i("update-report-form",{fieldName:w.subredditFieldName,value:"",button:{isDisabled:!0}})),this.dispatchEvent(i("update-ban-evasion-nodes",{subredditNode:null})),this.subredditNode=void 0},this.initializeUserInput=()=>{this.userInput?.classList.remove("hidden"),this.addAccountsToggle?.classList.add("hidden"),this.userInput.onchange=t=>{const e=t.detail??void 0;this.dispatchEvent(i("update-report-form",{fieldName:"additionalUsers",value:e.map((t=>t.id))})),this.dispatchEvent(i("update-ban-evasion-nodes",{userNodes:this.userInput?.selectedRedditorTemplates}))}}}get subredditInput(){return this.querySelector("shreddit-community-search")}get addAccountsToggle(){return this.querySelector("#report-additional-accounts")}get userInput(){return this.querySelector("mod-user-search-and-preview")}get reportFormManager(){return document.querySelector("report-page-manager")?.querySelector("shreddit-slotter")?.shadowRoot?.querySelector("report-form-manager")}firstUpdated(){this.updateComplete.then((()=>{this.repopulateScreen(),this.subredditInput?.addEventListener("change",(t=>{const e=t.target,s=e?.shadowRoot?.querySelector("li[rpl-selected] div span")?.cloneNode(!0);s.querySelector("faceplate-number").innerHTML="";const r=e.communityId;this.subredditNode=s,this.dispatchEvent(i("update-report-form",{fieldName:w.subredditFieldName,value:r,nextAction:w.nextAction,button:{isDisabled:!1}})),this.dispatchEvent(i("update-ban-evasion-nodes",{subredditNode:this.subredditNode}))})),this.addAccountsToggle?.addEventListener("click",this.initializeUserInput)}))}render(){return p` ${this.subredditNode?p` <div class="rounded-2 pl-xs pr-md bg-neutral-background-selected flex items-center justify-between py-sm"> ${this.subredditNode} ${r({appearance:"plain",attributes:{onclick:()=>this.clearSubredditSelection(),"aria-label":"Retirer la communauté sélectionnée"},leadingIcon:g()})} </div> `:p`<slot name="subreddit-selector"></slot>`} <hr class="border-b border-neutral-border my-md"> <slot name="additional-usernames"></slot> `}};x.styles=[t],x.subredditFieldName="subredditId",x.usersFieldName="additionalUsers",x.nextAction={type:m.SUPPORTING_EVIDENCE,step:b.FREE_TEXT},e([s()],x.prototype,"subredditNode",void 0),e([s()],x.prototype,"userNodes",void 0),x=w=e([o("ban-evasion-step")],x);let N=class extends h{constructor(){super(...arguments),this.updateFormState=(t,e=!1)=>{const s=t.getAttribute("name")??"",r=this.textarea?.value??"",o=t.getAttribute("data-nextaction")??void 0,n=t.getAttribute("data-next-step")??"",a=!!e;this.dispatchEvent(i("update-report-form",{fieldName:s,value:r,nextAction:{type:o,step:n},button:{isDisabled:a}}))},this.dispatchReportEvent=()=>{this.dispatchEvent(i("report-tracking",{reportFlow:{flowOptionSelected:S.FREE_TEXT,flowContent:this.textarea?.value??""}}))},this.addFreeTextListener=()=>{const t=this.textarea;t&&(t.addEventListener("input",(t=>{t.stopImmediatePropagation(),this.updateFormState(t.currentTarget),this.dispatchReportEvent()})),t.addEventListener("keyup",(()=>{0===t.value.length&&"FREE_TEXT"!==t.getAttribute("name")&&this.updateFormState(t,!0)})))}}get textarea(){return this.querySelector("faceplate-textarea-input")}firstUpdated(){this.updateComplete.then((()=>{"FREE_TEXT"===this.textarea?.getAttribute("name")&&this.updateFormState(this.textarea),this.addFreeTextListener()}))}render(){return p` <slot></slot>`}};N=e([o("free-textbox")],N);class O extends h{constructor(){super(...arguments),this.updateFormState=(t,e)=>{const s=t.getAttribute("name")??"",r=t.getAttribute("value")??"",o=t.getAttribute("data-ref")??"",n=t.getAttribute("data-nextaction")??void 0,a=t.getAttribute("data-next-step")??"",d=t.getAttribute("data-supporting-evidence")?.split(",")??void 0,l=!(!e||this.textarea?.value.length);this.dispatchReportEvent({fieldName:s,value:r,url:o}),this.dispatchEvent(i("update-report-form",{fieldName:s,value:r,nextAction:{type:n,url:o,step:a},supportingEvidence:d,button:{isDisabled:l}}))},this.dispatchReportEvent=t=>{const{fieldName:e,value:s,url:r}=t,o=this.determineFlowOptionSelected(e,s);this.dispatchEvent(i("report-tracking",{reportFlow:{flowOptionSelected:o,flowOutboundLink:r}}))},this.determineFlowOptionSelected=(t,e)=>"SUBREDDIT"===t&&"customResponse"===e?S.CUSTOM_RESPONSE:t===v.REPORT_REASONS?S.REPORT_REASON:S.REPORT_SUBREASON}get textarea(){return this.querySelector("faceplate-textarea-input")}}let q=class extends O{constructor(){super(...arguments),this.addPolicyOptionListeners=()=>{const t=this.querySelectorAll("faceplate-radio-input");t?.length&&t.forEach((t=>{t.addEventListener("input",(t=>{t.stopImmediatePropagation();const e=t.currentTarget;this.updateFormState(e)}))}))}}firstUpdated(){this.addPolicyOptionListeners()}render(){return p` <slot></slot>`}};q=e([o("user-detail-options")],q);let F=class extends O{constructor(){super(...arguments),this.pubsub=new a(this),this.isStandalone=!1,this.getFormElementById=t=>this.querySelector(`#${t}`),this.updateSelection=t=>{const e=this.selectedReason;this.isStandalone||(e&&(e.classList.remove("button-activated"),e.ariaChecked=null),t.classList.add("button-activated"),t.ariaChecked="true"),e?.removeAttribute("aria-describedby"),t.setAttribute("aria-describedby","report-footer-content-body")},this.updatePolicyOptionsUI=t=>{const e=t.getAttribute("data-description"),s=t.innerText;s&&this.titleElement&&(this.titleElement.textContent=s),e&&this.descriptionElement&&(this.descriptionElement.textContent=e),this.isStandalone&&this.pubsub.publish(d.ReportPageSummaryUpdate,{reportReasonTitle:s,reportReasonDesc:e})},this.addPolicyOptionListeners=()=>{const t=this.reasonOptions;t?.length&&t.forEach((t=>{t.addEventListener("click",(t=>{t.stopImmediatePropagation(),this.updatePolicyOptionsUI(t.currentTarget),this.updateSelection(t.currentTarget),this.updateFormState(t.currentTarget)}))}))}}get selectedReason(){return this.isStandalone?this.querySelector("[data-buttonbar] faceplate-radio-input[aria-describedby]"):this.querySelector("[data-buttonbar] button.button-activated")}get reasonOptions(){return this.isStandalone?this.querySelectorAll("[data-buttonbar] faceplate-radio-input"):this.querySelectorAll("[data-buttonbar] button")}get titleElement(){return this.getFormElementById("report-footer-content-title")}get descriptionElement(){return this.getFormElementById("report-footer-content-body")}firstUpdated(){this.addPolicyOptionListeners()}render(){return p` <slot></slot>`}};e([n({type:Boolean,attribute:"is-standalone"})],F.prototype,"isStandalone",void 0),F=e([o("policy-options")],F);let U=class extends O{constructor(){super(...arguments),this.addPolicyOptionListeners=()=>{const t=this.querySelectorAll("faceplate-radio-input");t?.length&&t.forEach((t=>{t.addEventListener("input",(t=>{t.stopImmediatePropagation();const e=t.currentTarget,s=e.hasAttribute("value")&&"customResponse"===e.getAttribute("value");s?(this.textarea?.classList.remove("hidden"),this.textarea?.scrollIntoView()):this.textarea?.classList.add("hidden"),this.updateFormState(e,s)}))}))}}get textarea(){return this.querySelector("faceplate-textarea-input")}firstUpdated(){this.addPolicyOptionListeners()}render(){return p` <slot></slot>`}};var I;U=e([o("followup-policy-options")],U);const _=l(h);let C=I=class extends _{get slotter(){return this.querySelector("shreddit-slotter")?.shadowRoot}get actionButton(){return this.slotter?.querySelector("#report-action-button")}get actionLinkButton(){return this.slotter?.querySelector("#report-action-link-button")}get backButton(){const t=this.closest("#report-flow-modal-card")?this.closest("#report-flow-modal-card"):this.closest("#mobile-report-flow-bottom-sheet");return this.isStandalone?this.slotter?.querySelector("#report-action-button-back"):t?.querySelector("#report-modal-back")}get closeButton(){const t=this.closest("#report-flow-modal-card")?this.closest("#report-flow-modal-card"):this.closest("#mobile-report-flow-bottom-sheet");return t?.querySelector("#report-modal-close")}get contentLoader(){return this.isStandalone?this.reportPageManager?.querySelector("shreddit-slotter")?.shadowRoot?.querySelector("#report-flow-content-loader"):document.querySelector("#report-flow-content-loader")}get contentWrapper(){return this.isStandalone?this.reportPageManager?.querySelector("shreddit-slotter")?.shadowRoot?.querySelector("#report-flow-content-wrapper"):document.querySelector("#report-flow-content-wrapper")}get standAloneReportTitle(){return this.querySelector("#stand-alone-title")}get reportPageManager(){return document.querySelector("report-page-manager")}get nextStepIsSuccess(){return this.nextAction?.type===m.SUBMIT||this.nextAction?.type===m.FLOW_SUBMIT}firstUpdated(){this.updateComplete.then((()=>{if(this.contentLoader?.classList.add("hidden"),this.contentWrapper?.classList.remove("hidden"),!this.isStandalone)return;this.reportPageManager&&Object.keys(this.reportPageManager?.reportPageFormValues).length&&(this.formValues=this.reportPageManager.reportPageFormValues[this.standAloneReportType]),this.reportPageManager&&this.reportPageManager.banEvasionNodesCache&&(this.banEvasionAdditionalUserNodes=this.reportPageManager.banEvasionNodesCache.banEvasionAdditionalUserNodes,this.banEvasionSubredditNode=this.reportPageManager.banEvasionNodesCache.banEvasionSubredditNode);const t=this.screenSequence[0];this.dispatchEvent(i("report-page-update-state-values",{lastRFScreen:t})),this.renderBackButton(),this.repopulateReportForm(t),this.applyStandAloneTitle(),this.pubsub.publish(d.ReportPageSummaryUpdate,{thingId:this.thingId,authorAvatar:this.authorAvatar,authorId:this.authorId,authorName:this.authorName,hideSummary:!1})}))}constructor(){super(),this.pubsub=new a(this),this.isUserBlocked=!1,this.isModerator=!1,this.isStandalone=!1,this.standAloneReportType="",this.permalink="",this.countryCode="",this.formValues={},this.supportingEvidence=[],this.nextAction={type:m.OPTIONS},this.requestClientGQL=c,this.changeStep=t=>{const e=i("shreddit-slotter-set-slot-name",{slotName:t});this.slotter?.dispatchEvent(e),this.renderBackButton(),this.isStandalone&&this.applyStandAloneTitle()},this.getFlowType=()=>this.reportPageManager?E.REPORT_PAGE:this.isModerator?E.MOD_CONTENT:E.USER_CONTENT,this.reportTracking=t=>{const{reportFlow:{flowOptionSelected:e,flowContent:s,flowOptionAvailable:i,flowOutboundLink:r},userTargetStatus:o}=t.detail,n={report_flow:{flow_type:this.getFlowType(),flow_option_selected:e??"",flow_content:s??"",flow_option_available:i??"",flow_outbound_link:r??""},user_target_status:{target_user_is_blocked_by_user:o?.targetUserisBlockedByUser??this.isUserBlocked},thingId:this.thingId};this.trackEvent(y(n))},this.displayBanEvasionError=()=>{this.dispatchEvent(i("faceplate-alert",{level:u.error,cause:"uncategorized",message:"Pour signaler un contournement d’exclusion par un membre, tu dois être modo de la communauté dont il a été exclu."})),this.screenSequence=[...this.screenSequence.slice(0,this.screenSequence.indexOf("BAN_EVASION_USERS")+1)],this.changeStep(v.BAN_EVASION)},this.performNextAction=()=>{switch(this.nextAction?.type){case m.OPTIONS:case m.SUBREDDIT_RULES:this.nextAction.step&&this.changeStep(this.nextAction.step);break;case m.FLOW:this.isStandalone&&this.nextAction.step?this.changeStep(this.nextAction.step):(this.closeReportFlow(),this.pubsub.publish(d.CTLReportInit,{authorName:this.authorName,thingId:this.thingId,userDetailType:this.formValues.USER_DETAILS}));break;case m.FLOW_SUBMIT:case m.SUBMIT:this.nextAction.step&&this.submitReport(this.thingId,this.formValues,this.nextAction.step,this.isStandalone);break;case m.URL:this.reportTracking({detail:{reportFlow:{flowOptionSelected:S.OUTBOUND_LINK}}}),"DSA"===this.formValues.REPORT_REASONS&&this.nextAction.url&&this.countryCode?window.open(T(this.nextAction.url,this.countryCode,this.permalink,this.isStandalone)):window.open(this.nextAction.url),this.isStandalone||this.closeReportFlow();break;case m.SUPPORTING_EVIDENCE:this.nextAction.step&&this.changeStep(this.nextAction.step)}this.nextAction=void 0},this.submitReport=async(t,e,s,i)=>{this.toggleButtonLoadingIndicator();const r=B(t);try{const o=A(r,t,e,i),n=await this.reportRequest(r,o);if(!n||n.errors&&n.errors.length||!R(n)){if(n?.errors[0]?.message.includes("reportRedditor NotAuthorizedError"))throw new Error(I.banEvasionError);throw new Error("Unsuccessful report response")}this.reportTracking({detail:{reportFlow:{flowOptionSelected:S.REPORT_SUBMIT}}}),this.changeStep(s)}catch(t){if(t.message===I.banEvasionError)return this.displayBanEvasionError();this.dispatchReportErrorAlert()}},this.toggleButtonLoadingIndicator=()=>{this.actionButton?.querySelector("faceplate-progress")?.classList.toggle("hidden"),this.actionButton?.querySelector("span.report-button-content")?.classList.toggle("opacity-0")},this.reportRequest=async(t,e)=>{const s=L(t,this.isStandalone);if(!s)throw new Error("No corresponding gql operation for the item type provided");try{return await this.requestClientGQL({operation:s,variables:{input:e}})}catch(t){throw new Error("Error calling the gql report operation")}},this.dispatchReportErrorAlert=()=>{this.dispatchEvent(i("faceplate-alert",{level:u.error,cause:"uncategorized",message:"Une erreur est survenue lors de l’envoi du signalement. Attends un peu, puis réessaie."})),this.toggleButtonLoadingIndicator()},this.getBlockingTracking=t=>{const e=this.isUserBlockingSwitchChecked&&this.isStandalone,s=t?.level===u.success;return{includeBlockingStatus:e||!!t,blockingStatus:!!e||s}},this.handleFormDone=async t=>{if(t){const{buttonAction:e}=t.detail;if(e===S.REPORT_FLOW_DONE||e===S.SUBMIT_ANOTHER){const t=await this.handleReportFlowUserBlocking(),{includeBlockingStatus:s,blockingStatus:i}=this.getBlockingTracking(t),r={reportFlow:{flowOptionSelected:e},...s?{userTargetStatus:{targetUserisBlockedByUser:i}}:{}};this.reportTracking({detail:r})}}},this.closeReportFlow=async t=>{await this.handleFormDone(t),this.pubsub.publish(d.ReportFlowClose)},this.updateBlockingSwitch=t=>{this.isUserBlockingSwitchChecked=t.detail.isChecked},this.handleReportFlowUserBlocking=async()=>{if(this.isUserBlockingSwitchChecked&&!this.isStandalone){const{level:t,message:e}=await k(!1,this.authorId,this.authorName);return this.dispatchEvent(i("faceplate-alert",{level:t,message:e})),{level:t,message:e}}},this.updateStepHistory=t=>{t&&(this.screenSequence=[...this.screenSequence,t])},this.onButtonClick=t=>{t.stopImmediatePropagation(),this.nextStepIsSuccess||this.updateStepHistory(this.nextAction?.step),this.performNextAction(),this.repopulateReportForm(this.screenSequence[this.screenSequence.length-1]),this.reportTracking({detail:{reportFlow:{flowOptionSelected:S.NEXT_BUTTON}}})},this.getButtonLabel=()=>this.nextAction?.type===m.SUBMIT?"Envoyer":"Suivant",this.updateButton=(t,e=!0)=>{if(this.nextAction?.url&&this.actionLinkButton)this.actionLinkButton.classList.remove("hidden"),this.actionLinkButton.href=this.nextAction.url,this.actionLinkButton?.addEventListener("click",this.onButtonClick),this.actionButton?.classList.add("hidden");else if(this.actionButton){this.actionButton?.addEventListener("click",this.onButtonClick);const s=this.actionButton.querySelector("span.report-button-content");s&&e&&(s.textContent=this.getButtonLabel()),void 0!==t&&(this.actionButton.disabled=t),this.actionLinkButton?.classList.add("hidden"),this.actionButton?.classList.remove("hidden")}},this.updateFormValues=(t,e)=>{this.formValues={...this.formValues,[t]:e}},this.updateBanEvasionNodes=t=>{const{subredditNode:e,userNodes:s}=t.detail;void 0!==e&&(this.banEvasionSubredditNode=e),void 0!==s&&(this.banEvasionAdditionalUserNodes=s)},this.updateReportForm=t=>{const{fieldName:e,value:s,nextAction:i,supportingEvidence:r,button:o}=t.detail;i&&(this.nextAction=i),r&&(this.supportingEvidence=r),this.updateFormValues(e,s),this.updateButton(o?.isDisabled,o?.updateButtonText)},this.hideTitle=()=>{this.standAloneReportTitle?.classList.add("hidden")},this.applyStandAloneTitle=()=>{if(!this.standAloneReportTitle)return;const t=this.standAloneReportType===f.CONTENT?"Signaler du contenu":"Signaler un ou plusieurs comptes";this.screenSequence[this.screenSequence.length-1]===v.CTL_STEP_ONE?this.standAloneReportTitle.textContent="Rapport de crise":this.standAloneReportTitle.textContent=t},this.renderBackButton=async()=>{if(await this.updateComplete,!this.backButton)return;this.backButton?.addEventListener("click",this.navigateBack);const t=this.screenSequence[this.screenSequence.length-1];this.screenSequence.length>1&&"SUCCESS"!==t||this.isStandalone?(this.backButton.classList.remove("hidden"),this.backButton.disabled=!1):(this.backButton.classList.add("hidden"),this.backButton.disabled=!0)},this.navigateBack=()=>{const t=this.screenSequence,e=t.slice(0,t.length);e.pop(),this.screenSequence=e;const s=e[e.length-1];this.backButton?.classList.contains("report-reasons-screen")&&(this.dispatchEvent(i("report-page-update-state-values",{formValues:this.formValues,banEvasionNodes:{banEvasionSubredditNode:this.banEvasionSubredditNode,banEvasionAdditionalUserNodes:this.banEvasionAdditionalUserNodes}})),this.pubsub.publish(d.ReportPageSummaryUpdate,{hideSummary:!0})),this.changeStep(s),this.repopulateReportForm(s),this.reportTracking({detail:{reportFlow:{flowOptionSelected:S.BACK_ARROW}}})},this.getStepValue=t=>this.formValues[t],this.repopulateReportForm=async t=>{if(await this.updateComplete,!t)return;const e=this.getStepValue(t);if(!e)return;const s=this.slotter?.querySelectorAll("[data-buttonbar] button"),i=this.slotter?.querySelectorAll("faceplate-radio-input"),r=this.slotter?.querySelector("faceplate-textarea-input");if(s?.length&&this.applyButtonBarButtonValue(e),i?.length&&this.applyRadioButtonValue(e),r){const s={step:t,stepValue:e,textarea:r};this.applyTextAreaValue(s)}},this.applyTextAreaValue=async({step:t,stepValue:e,textarea:s})=>{if("SUBREDDIT"===t){if(!this.formValues.customResponse?.length&&"customResponse"===e){const e={detail:{fieldName:t,value:"",button:{isDisabled:!0}}};this.updateReportForm(e)}"customResponse"===e&&(s.classList.remove("hidden"),await s.updateComplete,s.scrollIntoView()),s.setAttribute("value",this.formValues.customResponse??"")}"FREE_TEXT"===t&&s.setAttribute("value",e)},this.applyButtonBarButtonValue=t=>{const e=this.slotter?.querySelector(`[data-buttonbar] button[value="${t}"]`);if(!e)return;e.classList.add("button-activated"),e.ariaChecked="true",e.setAttribute("aria-describedby","report-footer-content-body");const s=e.getAttribute("data-description"),i=e.innerText;i&&(this.slotter.querySelector("#report-footer-content-title").textContent=i),s&&(this.slotter.querySelector("#report-footer-content-body").textContent=s),this.applyActionButtonValue(e)},this.applyRadioButtonValue=t=>{const e=this.slotter?.querySelector(`faceplate-radio-input[value="${t}"]`);if(!e)return;e.setAttribute("checked","true"),this.applyActionButtonValue(e);const s=e.getAttribute("data-description");if(this.isStandalone&&s){const t=e.innerText;this.pubsub.publish(d.ReportPageSummaryUpdate,{reportReasonTitle:t,reportReasonDesc:s})}},this.applyActionButtonValue=t=>{const e=t.getAttribute("name")??"",s=t.getAttribute("value")??"",i=t.getAttribute("data-ref")??"",r=t.getAttribute("data-nextaction")??void 0,o=t.getAttribute("data-next-step")??"",n=t.getAttribute("data-supporting-evidence")?.split(","),a={detail:{fieldName:e,value:s,nextAction:{type:r,url:i,step:o},supportingEvidence:n,button:{isDisabled:!1}}};this.updateReportForm(a)};const t=this.querySelector("shreddit-slotter")?.getAttribute("slot-name");this.screenSequence=t?[t]:[],this.addEventListener("update-report-form",this.updateReportForm),this.addEventListener("close-report-form",this.closeReportFlow),this.addEventListener("handle-form-done",this.handleFormDone),this.addEventListener("report-tracking",this.reportTracking),this.addEventListener("update-blocking-switch",this.updateBlockingSwitch),this.addEventListener("update-ban-evasion-nodes",this.updateBanEvasionNodes),this.addEventListener("hide-page-title-success-screen",this.hideTitle),this.closeButton?.addEventListener("click",(()=>{this.reportTracking({detail:{reportFlow:{flowOptionSelected:S.X_OUT}}})}))}render(){return p` <slot></slot>`}};C.styles=[t],C.banEvasionError="Ban Evasion: Not Authorized",e([n({type:String,attribute:"author-id"})],C.prototype,"authorId",void 0),e([n({type:String,attribute:"author-name"})],C.prototype,"authorName",void 0),e([n({type:String,attribute:"author-avatar"})],C.prototype,"authorAvatar",void 0),e([n({type:String,attribute:"thing-id"})],C.prototype,"thingId",void 0),e([n({type:Boolean,attribute:"is-user-blocked"})],C.prototype,"isUserBlocked",void 0),e([n({type:Boolean,attribute:"is-moderator"})],C.prototype,"isModerator",void 0),e([n({type:Boolean,attribute:"is-standalone"})],C.prototype,"isStandalone",void 0),e([n({type:String,attribute:"standalone-report-type"})],C.prototype,"standAloneReportType",void 0),e([n({type:String,attribute:"permalink"})],C.prototype,"permalink",void 0),e([n({type:String,attribute:"country-code"})],C.prototype,"countryCode",void 0),e([s()],C.prototype,"formValues",void 0),C=I=e([o("report-form-manager")],C);let P=class extends h{constructor(){super(...arguments),this.pubsub=new a(this),this.addDoneListener=()=>{this.doneButton?.addEventListener("click",(()=>{this.dispatchEvent(i("close-report-form",{buttonAction:S.REPORT_FLOW_DONE}))}))},this.addSubmitAnotherListener=()=>{this.submitAnotherButton?.addEventListener("click",(()=>{this.dispatchEvent(i("handle-form-done",{buttonAction:S.SUBMIT_ANOTHER}))}))},this.hideElements=()=>{this.dispatchEvent(i("hide-page-title-success-screen")),this.pubsub.publish(d.ReportPageSummaryUpdate,{hideSummary:!0})}}get doneButton(){const t=this.querySelector("#report-action-link-button");return!t||t?.className.includes("hidden")?this.querySelector("#report-action-button"):t}get submitAnotherButton(){return this.querySelector("#report-submit-another-link-button")}firstUpdated(){this.hideElements(),this.updateComplete.then((()=>{this.addDoneListener(),this.addSubmitAnotherListener()}))}};P=e([o("base-success-step")],P);let M=class extends P{constructor(){super(...arguments),this.toggleButtonLoadingIndicator=()=>{this.blockingModule?.querySelector("faceplate-progress")?.classList.toggle("hidden"),this.blockingModule?.querySelector("span.report-button-content")?.classList.toggle("opacity-0")},this.dispatchReportEvent=t=>{this.dispatchEvent(i("report-tracking",{reportFlow:{flowOptionSelected:t}}))},this.dispatchBlockEvents=t=>{this.dispatchEvent(i("update-blocking-switch",{isChecked:t})),this.dispatchReportEvent(S.BLOCK_USER_TOGGLE)},this.addUserBlockingSwitchListener=()=>{this.userBlockingSwitch?.addEventListener("click",(()=>{this.dispatchBlockEvents(this.userBlockingSwitch?.checked??!1)}))},this.addUserBlockingButtonListeners=()=>{this.blockingModule?.addEventListener("click",(()=>{this.toggleButtonLoadingIndicator()})),this.blockingModule?.addEventListener("blocked-state-update-error",(()=>{this.toggleButtonLoadingIndicator()})),this.blockingModule?.addEventListener("blocked-state-updated",(()=>{this.dispatchBlockEvents(!0),this.toggleButtonLoadingIndicator(),this.userBlockingButton?.setAttribute("disabled",""),this.userBlockingButton.innerText="Bloqué·e"}))}}get userBlockingSwitch(){return this.querySelector("faceplate-switch-input")}get blockingModule(){return this.querySelector("user-blocking")}get userBlockingButton(){return this.blockingModule?.querySelector("#block-user-button")}firstUpdated(){super.firstUpdated(),this.updateComplete.then((()=>{this.addUserBlockingSwitchListener(),this.addUserBlockingButtonListeners()}))}render(){return p` <slot></slot>`}};M=e([o("success-screen")],M);let V=class extends h{constructor(){super(...arguments),this.updateFormState=()=>{const t=this.getAttribute("name")??"",e=this.getAttribute("value")??"",s=this.getAttribute("data-nextaction")??void 0,r=this.getAttribute("data-next-step")??"";this.dispatchEvent(i("update-report-form",{fieldName:t,value:e,nextAction:{type:s,step:r},button:{updateButtonText:!1,isDisabled:!1}}))},this.dispatchReportEvent=t=>{this.dispatchEvent(i("report-tracking",{reportFlow:{flowOptionSelected:S.OUTBOUND_LINK,flowOutboundLink:t}}))}}get yesButton(){return this.querySelector("#report-action-button")}get crisisTextLineLink(){return this.querySelector('a[id="crisis-text-line-link"]')}get ctlOptionsLink(){return this.querySelector('a[id="ctl-options-link"]')}firstUpdated(){this.updateFormState(),this.ctlOptionsLink?.addEventListener("click",(()=>this.dispatchReportEvent(this.ctlOptionsLink?.href??""))),this.crisisTextLineLink?.addEventListener("click",(()=>this.dispatchReportEvent(this.crisisTextLineLink?.href??"")))}render(){return p` <slot></slot>`}};V=e([o("ctl-step-one")],V);let D=class extends P{constructor(){super(...arguments),this.dispatchReportEvent=t=>{this.dispatchEvent(i("report-tracking",{reportFlow:{flowOptionSelected:S.OUTBOUND_LINK,flowOutboundLink:t}}))}}get listItemOne(){return this.querySelector('a[id="ctl-success-list-item-one"]')}get listItemTwo(){return this.querySelector('a[id="ctl-success-list-item-two"]')}firstUpdated(){super.firstUpdated(),this.listItemOne?.addEventListener("click",(()=>this.dispatchReportEvent(this.listItemOne?.href??""))),this.listItemTwo?.addEventListener("click",(()=>this.dispatchReportEvent(this.listItemTwo?.href??"")))}render(){return p` <slot></slot>`}};D=e([o("ctl-step-two")],D);
