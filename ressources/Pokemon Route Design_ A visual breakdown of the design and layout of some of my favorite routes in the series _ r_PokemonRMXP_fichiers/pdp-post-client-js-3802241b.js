import{_ as t,g as o,n as e,e as s,bL as i,t as n,v as r,s as l,u as a}from"./shell-a9dcd804.js";import"./partial-feed-post-client-js-695a46ae.js";import"./shreddit-post-flair-87afe3c9.js";import"./user-hover-card-client-js-7bc79c4a.js";import"./pdp-back-button-aef47cd0.js";import{s as m,a as p,A as c}from"./icon-d7ad820f.js";import{a1 as u}from"./age-gate-standalone-client-js-55e13342.js";import"./comment-link-post-client-js-7fc51f68.js";import{g as d}from"./password-recovery-d61e525b.js";import"./mod-log-takedown-preview-client-js-dd6db8b8.js";import"./shop-gallery-data-fetcher-client-js-cd71f78d.js";import"./index-e9ae10a6.js";import"./article-details-feed-client-js-d6722a9f.js";import"./index-dd5b6d97.js";import"./content-action-button-8d093e66.js";import"./award-controller-25d0c262.js";import"./awardsTelemetryState-70c8634d.js";import"./header-action-item-chat-client-js-949dafe8.js";import"./tooltip.base-a366add3.js";import"./rpl-popper-cdaac5d5.js";import"./modActions-183d7a2f.js";import"./mod-bulk-actions-9bc5f299.js";import"./distinguished-tags-4752ad65.js";import"./awards-395295be.js";import"./rpl-coachmark-abe2db02.js";import"./rpl-coachmark-card-c876a6a2.js";import"./mod-post-list-client-js-7b3a8a37.js";import"./content-tags-40bc141d.js";import"./overflow-menu-actions-ec094350.js";import"./shreddit-post-share-button-b3d16788.js";import"./expandable-section-header-a5b37930.js";import"./with-share-10c7b8d9.js";import"./promote-post-actions-controller-8a499415.js";import"./index-7436fa38.js";import"./profile-creation-1d60123b.js";import"./select-controller-b7a961d7.js";import"./user-flair-aefa9eac.js";import"./expandable-mod-reports-base-6a5750ae.js";import"./postFlair-9d6c2791.js";import"./promote-post-button-e731a210.js";import"./translation-intervention-modal-677b21bf.js";import"./translations-2dea4523.js";import"./chat-mobile-xpromo-client-js-342f9966.js";import"./app-selector-client-js-197aee07.js";import"./TinyGesture-89d9957c.js";import"./links-30dbf643.js";import"./v2-events-dc55f078.js";import"./mod-verdict-fdcc35ce.js";import"./gallery-fe8fc2ba.js";import"./community-club-highlights-client-js-2b06d5e7.js";import"./subreddit-posting-eligibility-c0987c5f.js";import"./index-4aa37bbb.js";import"./qr-code-modal-upsell-client-js-25088b6d.js";import"./comment-client-js-da2a7314.js";import"./cbau-81b2f8bd.js";import"./faceplate-progress-433a18f1.js";import"./follow-button-cd1154f3.js";import"./all-chats-page-recommendations-client-js-f8d39a9f.js";import"./click-location-tracker-3430eb18.js";let h=class extends m{constructor(){super(...arguments),this.isMobile=!1,this.showDurationS=8,this.postId="",this.isPillVisible=!1,this.hostCommentCount=0,this.isAddedTabEvent=!1,this.commentCountSubscriptionController=new i(this),this.onData=t=>{this.isAddedTabEvent||(document.querySelector(`.${u}`)?.addEventListener("click",this.handleAmaCommentTabClick),this.isAddedTabEvent=!0);const o=t.subscribe.data.hostCommentCountChange||0;o<=0||(this.hostCommentCount+=o,this.isPillVisible?clearTimeout(this.currentCountDown):this.isPillVisible=!0,this.currentCountDown=setTimeout((()=>{this.isPillVisible=!1}),1e3*this.showDurationS))},this.scrollToCommentsAndRefreshAnswers=()=>{const t=document.querySelector(`.${u}`)?.offsetTop;if(!t)return;const o=document.querySelector("nav")?.offsetHeight??0;window.scrollTo({top:t-o,behavior:"smooth"});const e=document.querySelector('button[value="answered"]');e?.click()},this.onPillClick=()=>{this.isPillVisible=!1,this.hostCommentCount=0,this.currentCountDown&&clearTimeout(this.currentCountDown),this.currentCountDown=void 0,this.scrollToCommentsAndRefreshAnswers()},this.handleAmaCommentTabClick=t=>{const o=t.target?.getAttribute("value"),e=o&&o.toLowerCase();"all"!==e&&"answered"!==e||(this.isPillVisible=!1,this.hostCommentCount=0,this.currentCountDown&&clearTimeout(this.currentCountDown))}}static get styles(){return[p`:host{left:50%;position:fixed;top:calc(var(--shreddit-header-height) + 32px);transform:translateX(-50%);z-index:1001}`,n]}getTitleText(){return r({count:this.hostCommentCount,one:`${this.hostCommentCount} nouvelle réponse`,few:`${this.hostCommentCount} nouvelles réponses`,many:`${this.hostCommentCount} nouvelles réponses`,other:`${this.hostCommentCount} nouvelles réponses`})}connectedCallback(){super.connectedCallback(),this.commentCountSubscriptionController.subscribe({query:{operationName:"SubscribeSubscription",query:"\n          subscription SubscribeSubscription($input: SubscribeInput!) {\n            subscribe(input: $input) {\n              ... on BasicMessage {\n                data {\n                  ... on CommentCountUpdateMessageData {\n                    hostCommentCountChange\n                  }\n                }\n              }\n            }\n          }\n          ",variables:{input:{channel:{teamOwner:"CONTENT_AND_COMMUNITIES",category:"COMMENT_COUNT_UPDATE",postID:this.postId}}}},onData:t=>{t.data&&this.onData(t.data)}})}disconnectedCallback(){super.disconnectedCallback(),document.querySelector(`.${u}`)?.removeEventListener("click",this.handleAmaCommentTabClick)}render(){return this.isPillVisible?l({appearance:"primary",attributes:{onclick:this.onPillClick},children:this.getTitleText(),size:this.isMobile?a.Small:a.Large,role:"button"}):c}};t([e({type:Boolean,attribute:"is-mobile"})],h.prototype,"isMobile",void 0),t([e({type:Number,attribute:"show-duration-in-s"})],h.prototype,"showDurationS",void 0),t([e({type:String,attribute:"post-id"})],h.prototype,"postId",void 0),t([o()],h.prototype,"isPillVisible",void 0),t([o()],h.prototype,"hostCommentCount",void 0),h=t([s("ama-new-comment-pill")],h),"enabled"===window.CLIENT_EXPERIMENTS?.shreddit_pdp_no_mod_js_lo?d()&&import("./index-logged-in-db8ebff8.js"):import("./index-logged-in-db8ebff8.js");
