import{t as e,_ as t,g as s,G as n,e as a,n as i,s as r,a as o,I as l,b as c,c as d,cy as p}from"./shell-a9dcd804.js";import{s as h,x as u,l as m,a2 as b,A as v,c as g,a as f,I as w,aG as C}from"./icon-d7ad820f.js";import{T as k,ap as y}from"./age-gate-standalone-client-js-55e13342.js";import{r as x,F as _}from"./render-toast-8d3aa6c3.js";import"./banned-user-banner-client-js-fe0e5e4a.js";import{T as E}from"./TinyGesture-89d9957c.js";let T=class extends h{constructor(){super(...arguments),this.isVisible=!1,this.alertMessage="",this.isDevelopment=!1,this.appearance="plain",this.openBanner=e=>{const t=e;this.alert=t.detail;const{level:s=n.none}=this.alert,a="Erreur du serveur. Merci de réessayer plus tard.",i=this.alert?.content??this.alert?.message??a;switch(s){case n.emergency:case n.alert:case n.critical:case n.error:this.appearance="error";break;case n.warning:case n.notice:this.appearance="caution";break;case n.success:this.appearance="success";break;default:this.appearance="plain"}const r=`Plusieurs erreurs se sont produites, dont : ${i}`;s<=n.success||this.isDevelopment?this.isVisible?this.alertMessage=this.isDevelopment?r:a:(this.alertMessage=i,this.isVisible=!0):this.isVisible=!1},this.closeBanner=()=>{this.isVisible=!1}}connectedCallback(){super.connectedCallback(),this.addEventListener("show-banner",this.openBanner)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("show-banner",this.openBanner)}render(){return u`${this.isVisible?u`<faceplate-banner class="z-5 pointer-events-auto w-full rounded-none l:rounded-[0.75rem] xl:rounded-[0.75rem] overflow-hidden l:mt-md l:mx-auto l:max-w-[1352px] xl:max-w-[1524px]" appearance="${this.appearance}" shape="square" msg="${m(this.alertMessage)}" aria-live="polite" dismissible><div slot="leadingIcon"> ${this.alert?.namedContent?.icon?this.alert.namedContent.icon:b()} </div> <span slot="closeButton"> ${k("error",{"aria-label":"close error button",onclick:this.closeBanner})} </span> </faceplate-banner>`:v}<slot></slot>`}};T.styles=[e],t([s()],T.prototype,"isVisible",void 0),t([s()],T.prototype,"alertMessage",void 0),T=t([a("banner-controller")],T);let L=class extends h{constructor(){super(...arguments),this.ariaLive="polite",this._gesture=new E(this,{mouseSupport:!0}),this.handleToast=e=>{const t=e.detail,s={...t,meta:{...t.meta},namedContent:{...t.namedContent}},{level:a,namedContent:i,meta:o}=s;i.action??(i.action=r({attributes:{onclick:()=>l.dismiss()},appearance:"plainInverted",leadingIcon:g()}));const l=x(this,s);a&&a>=n.warning&&a<=n.success&&!o?.disableAutoDismiss&&window.setTimeout((()=>{l.dismiss()}),o?.duration??4e3),this.appendChild(l)}}static get styles(){return f`:host{position:fixed}:host>slot{display:flex;flex-direction:column;gap:var(--spacer-md);align-items:center;position:fixed;left:50%;transform:translateX(-50%);padding:0 1rem;bottom:var(--rem16)}`}connectedCallback(){super.connectedCallback(),this.addEventListener("show-toast",this.handleToast),this._gesture.on("swipeleft",this._onSwipe),this._gesture.on("swiperight",this._onSwipe)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("show-toast",this.handleToast),this._gesture.destroy()}_onSwipe(e){if(e instanceof MouseEvent)return;const t=e.target instanceof HTMLElement?e.target:null,s=t?.closest("faceplate-toast");s instanceof _&&s.dismiss()}render(){return u`<slot></slot>`}};t([i({type:String,reflect:!0,attribute:"aria-live"})],L.prototype,"ariaLive",void 0),L=t([a("toaster-lite")],L);const B=o(h);let M=class extends B{constructor(){super(...arguments),this.ariaLive="polite",this.min=n.error,this.max=n.success,this.BATCH_TIMEOUT=100,this._alertsCtrl=new y(this,{batchWindow:this.BATCH_TIMEOUT,onAlert:e=>{const{level:t=n.none}=e;if(e.namedContent=e.namedContent||{},!e.namedContent.icon)switch(t){case n.emergency:case n.alert:case n.critical:case n.error:e.namedContent.icon=C({size:w.Large});break;case n.warning:case n.notice:e.namedContent.icon=b({size:w.Large})}if(t<=n.error)return this._trackEvent(e,"banner"),this.triggerBanner(e);this._trackEvent(e,"toast"),this.triggerToast(e)},isOnline:()=>!0}),this._trackEvent=(e,t)=>{this.trackEvent(c({source:"client",action:"record",noun:"alert"},{action_info:{feature:e.sourceElement||"unknown",reason:e.cause||e.message||"unknown",setting_value:`${e.level??"unknown"}`,type:t}}))},this.triggerToast=e=>{this.toaster?.dispatchEvent(d("show-toast",e))},this.triggerBanner=e=>{this.bannerController?.dispatchEvent(d("show-banner",e))}}connectedCallback(){super.connectedCallback(),this._alertsCtrl.options.min=this.min,this._alertsCtrl.options.max=this.max}render(){return u` <banner-controller></banner-controller> <toaster-lite></toaster-lite> `}};M.styles=[f`:host{position:fixed;width:100%}`,e],t([i({type:String,reflect:!0,attribute:"aria-live"})],M.prototype,"ariaLive",void 0),t([i({attribute:"min",converter:p})],M.prototype,"min",void 0),t([i({attribute:"max",converter:p})],M.prototype,"max",void 0),t([l("banner-controller")],M.prototype,"bannerController",void 0),t([l("toaster-lite")],M.prototype,"toaster",void 0),M=t([a("alert-controller")],M);
