import"./faceplate-expandable-section-helper-e0bffc58.js";import{C as t,a as e}from"./article-details-feed-client-js-d6722a9f.js";import{a as i,N as a,b as s,bj as r,K as o,O as d,T as n,c as l,G as c,t as u,s as h,u as p,_ as m,n as v,e as g,q as f,g as F}from"./shell-a9dcd804.js";import{x as S,H as y,I as b,Z as N,_ as C,s as $,ae as k}from"./icon-d7ad820f.js";import{l as x,L as j}from"./expandable-section-header-a5b37930.js";import"./custom-feed-edit-button-cb2bb11c.js";const _="community_nav";let w=class extends(i(a($))){constructor(){super(...arguments),this.multiredditPath="",this.displayName="",this.iconSrc="",this.isFavorited=!1,this.sanNoun="",this.getTrackingContext=()=>({customFeed:{id:this.multiredditPath}}),this.onFavoriteClick=async()=>{this.trackEvent(s({source:_,action:"click",noun:this.isFavorited?"unfavorite":"favorite"},this.getTrackingContext()));try{const t={input:{label:this.multiredditPath,favoriteState:this.isFavorited?r.None:r.Favorited}},{data:e}=await o({operation:d.UpdateMultiredditFavoriteState,variables:t});if(e.updateMultiredditFavoriteState?.ok){const t={path:this.multiredditPath,isFavorited:!this.isFavorited};return void this.publish(n.MultiredditFavoriteStatusChange,t)}throw new Error("error updating custom feed favorite status")}catch(t){const e=this.isFavorited?`Impossible de retirer ${this.displayName} des favoris`:`Impossible d’ajouter ${this.displayName} aux favoris`;this.dispatchEvent(l("faceplate-alert",{level:c.error,cause:"uncategorized",message:e}))}}}static get styles(){return[u]}updated(t){}render(){const t=S`<span class="mr-[2px]">${this.iconSrc?S`<img class="rounded-full" loading="lazy" src="${this.iconSrc}" width="32" height="32" aria-hidden="true" alt="custom feed icon">`:y({size:b.Large})}</span>`;return S`<faceplate-tracker source="${_}" action="click" noun="custom_feed" data-faceplate-tracking-context="${JSON.stringify(this.getTrackingContext())}">${x({href:this.multiredditPath,innerClassName_DO_NOT_USE:"s:rounded-2 bg-transparent",label:S`<div class="truncate">${this.displayName}</div>`,leadingAvatar:t,size:j.Small,trailingSlot:S` ${h({appearance:"plain",leadingIcon:(this.isFavorited?N:C)({size:b.Small}),size:p.Small,attributes:{"aria-label":this.isFavorited?"Retirer le flux personnalisé des favoris":"Ajouter un flux personnalisé aux favoris",onclick:t=>{t.preventDefault(),t.stopPropagation(),this.onFavoriteClick()}}})}`})}</faceplate-tracker>`}};m([v({type:String})],w.prototype,"multiredditPath",void 0),m([v({type:String})],w.prototype,"displayName",void 0),m([v({type:String})],w.prototype,"iconSrc",void 0),m([v({type:Boolean})],w.prototype,"isFavorited",void 0),m([v({type:String})],w.prototype,"sanNoun",void 0),w=m([g("left-nav-multireddit-item")],w);class O extends(a($)){constructor(){super(),this.initialStateJSON="[]",this.items=[],this.triggerReload=()=>{this.dispatchEvent(new CustomEvent(t))},this.updateFavoritedState=({path:t,isFavorited:e})=>{const i=[...this.items],a=i.findIndex((e=>e.path===t));-1!==a&&i[a].isFavorited!==e&&(i[a].isFavorited=e,this.items=P(i))},this.reloadController=new e(this,{reloadUrl:"/svc/shreddit/left-nav-multireddits-section",containerSelector:"left-nav-multireddits-controller",mode:f.Replace})}connectedCallback(){super.connectedCallback(),this.items=P(JSON.parse(this.initialStateJSON)),this.subscribe(n.MultiredditFavoriteStatusChange,this.updateFavoritedState),this.subscribe(n.CustomFeedUpdated,this.triggerReload,!1),this.subscribe(n.CustomFeedCreated,this.triggerReload,!1),this.subscribe(n.CustomFeedDeleted,this.triggerReload,!1)}render(){return S`<div> ${this.reloadController?.isLoading?S`<shreddit-loading></shreddit-loading>`:S`${k(this.items,(t=>S`<left-nav-multireddit-item sanNoun="${this.sanNoun}" multiredditPath="${t.path}" displayName="${t.displayName}" iconSrc="${t.icon}" ?isFavorited="${t.isFavorited}"></left-nav-multireddit-item>`))}`} </div>`}}function P(t){return[...t.sort(((t,e)=>t.isFavorited===e.isFavorited?t.displayName.toLowerCase()>e.displayName.toLowerCase()?1:-1:t.isFavorited?-1:1))]}m([v({type:String})],O.prototype,"initialStateJSON",void 0),m([F()],O.prototype,"items",void 0);let z=class extends O{constructor(){super(...arguments),this.sanNoun="multireddits_menu"}};z=m([g("left-nav-multireddits-controller")],z);
