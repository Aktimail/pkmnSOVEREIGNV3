import"./faceplate-search-input-28db656a.js";import{_ as e,e as t,a6 as s,c2 as o}from"./shell-a9dcd804.js";import{x as r}from"./icon-d7ad820f.js";import{R as a,a as n,S as i}from"./base-152646e8.js";import"./text-input-1e857ee0.js";import"./filterNullish-9ec33a16.js";import"./constants-775ffd1d.js";import"./validate-image-9f48337a.js";import"./age-gate-standalone-client-js-55e13342.js";import"./search-telemetry-tracker-e75ed6e5.js";import"./post-consume-tracker-439de2af.js";import"./links-30dbf643.js";import"./search-typeahead-expandable-section-10a16564.js";import"./search-params-e13e0c5a.js";import"./search-dynamic-id-e5090dbf.js";import"./expandable-section-header-a5b37930.js";import"./ad-event-tracker-8c125454.js";import"./with-ad-observer-972950e0.js";import"./errors-8d0111b7.js";import"./overflow-menu-actions-ec094350.js";import"./distinguished-tags-4752ad65.js";import"./shreddit-dynamic-ad-link-77e5b3bd.js";import"./suggested-search-queries-client-js-e0844c90.js";import"./faceplate-expandable-section-helper-e0bffc58.js";import"./faceplate-auto-height-animator-af7aeb45.js";import"./content-tags-40bc141d.js";import"./pdp-seeker-cafdafe5.js";let c=class extends a{constructor(){super(...arguments),this.onKeyDown=e=>{const t="Escape"===e.key,s="Tab"===e.key,o=Boolean(s&&this.shadowRoot&&this.input&&this.shadowRoot.activeElement===this.input),r=s&&!e.shiftKey;t&&e.preventDefault(),(t||o||r)&&this.handleBlur()},this.getKeyboardNavigableDropdownItems=()=>{const e=`[role="menuitem"],summary[aria-controls*="${o}"]`,t=[];return[this.suggestedSearchResultsContainer,this.recentSearchesContainer,this.trendingSearchesContainer,this.typeaheadResultsContainer].forEach((s=>{if(!s)return;s.querySelectorAll(e).forEach((e=>{const s=null!==e.offsetParent&&e.offsetHeight>0,o="SUMMARY"===e.tagName,r=e.closest("faceplate-expandable-section-helper");s&&(o||!r||r.open)&&t.push(e)}))})),t},this.handleRecentSearchTabKeyNavigation=e=>{const t=e.target.querySelector(".recent-search-item-delete-button");e.shiftKey&&e.target.className.includes("recent-search-item-delete-button")?(e.target.closest('[role="menuitem"]')?.focus(),e.preventDefault(),e.stopPropagation()):!e.shiftKey&&t&&(t.focus(),e.preventDefault(),e.stopPropagation())},this.handleDropdownKeyDown=e=>{super.handleDropdownKeyDown(e);const t=e.target.closest(`#${n}`);if("Tab"===e.key&&t)this.handleRecentSearchTabKeyNavigation(e);else if("ArrowDown"===e.key||"ArrowUp"===e.key){e.preventDefault();const t=e.target,s=this.getKeyboardNavigableDropdownItems();let o=-1;s.forEach(((e,s)=>{e===t&&(o=s)}));const r="ArrowDown"===e.key?o+1:o-1,a=o>=0&&o<s.length?s[r]:void 0;a?a.focus():this.focusSearchInputWithArrowKeys()}}}connectedCallback(){super.connectedCallback(),this.addEventListener("keydown",this.onKeyDown)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("keydown",this.onKeyDown)}handleKeyDown(e){if(super.handleKeyDown(e),!["ArrowDown","ArrowUp"].includes(e.key))return;e.preventDefault();const t=this.getKeyboardNavigableDropdownItems();0!==t.length&&("ArrowDown"===e.key?t[0].focus():"ArrowUp"===e.key&&t[t.length-1].focus())}focusSearchInputWithArrowKeys(){const e=this.input?.shadowRoot?.querySelector("input");e?.focus();const t=e?.value.length;t&&e?.setSelectionRange(t,t)}render(){return r` <div class="reddit-search-bar rounded-5 w-[inherit] box-border ${s({"shadow-sm":this.isFocused,"bg-neutral-background-strong":this.isFocused,"bg-secondary-background":!this.isFocused})}" data-faceplate-tracking-context="${JSON.stringify(this.searchTelemetryData)}"> <div class="${s({"pb-[.5rem]":this.showDropdown&&!this.isSearchScopeEnabled,"pb-xs":this.showDropdown&&this.isSearchScopeEnabled,"border-b-sm":this.showDropdown,"border-t-0":this.showDropdown,"border-r-0":this.showDropdown,"border-l-0":this.showDropdown,"border-solid":this.showDropdown,"border-neutral-border-weak":this.showDropdown})}"> <form autocomplete="off" class="flex relative items-center text-neutral-content-strong" @submit="${this.handleSubmit}"> ${this.renderSearchInput(!0)} </form> </div> <div class="max-h-[calc(100vh-var(--shreddit-header-height)-15px-10px)] overflow-y-auto overflow-x-hidden m-t ${s({hidden:!this.showDropdown})}" id="${i}"> ${this.renderDropdownContent(!0)} </div> </div> `}};c=e([t("reddit-search-large")],c);
